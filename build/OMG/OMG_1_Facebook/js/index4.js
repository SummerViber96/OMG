"use strict";window.__adapter_init=function(){function base64toArrayBuffer(e){var o=window.atob(e.substring(e.indexOf(",")+1));let r=o.length;for(var t=new Uint8Array(r);r--;)t[r]=o.charCodeAt(r);return t.buffer}function base64ToBlob(e,o){e=e.split(",");let r=o;2===e.length&&(n=e.shift(),t=new RegExp(":(.*?);"),n=n.match(t),r=(n&&1<n.length?n[1]:o)||o);var t=e.shift(),a=window.atob(t),n=new ArrayBuffer(a.length),d=new Uint8Array(n);for(let e=0;e<a.length;e++)d[e]=a.charCodeAt(e);return new Blob([n],{type:r})}function convertBase64(e){var o=new RegExp("-","g");return e=(e=e.replace(o,"+")).replace(o,"/")}function __adapter_get_res_path(e,o){if(o[e])return e;for(var r in o){var t=e.indexOf(r);if(-1!==t&&t+r.length===e.length)return r}return null}function __adapter_get_resource(e){return window.__adapter_resource__[__adapter_get_res_path(e,window.__adapter_resource__)]}function loadText(e,o,r){o.responseType="text",r(null,__adapter_get_resource(e))}function loadJson(e,o,r){r(null,JSON.parse(__adapter_get_resource(e)))}function loadArrayBuffer(e,o,r){r(null,base64toArrayBuffer(__adapter_get_resource(e)))}function loadScript(url,options,onComplete){let data=__adapter_get_resource(url);data||console.error(url+" isn't load"),eval(data),onComplete&&onComplete(null)}function loadImage(e,o,r){var t=__adapter_get_resource(e);t||console.error(e+" isn't load");let a=new Image;const n=function(){a.removeEventListener("load",n),a.removeEventListener("error",d),r&&r(null,a)},d=function(){a.removeEventListener("load",n),a.removeEventListener("error",d),r&&r(new Error(cc.debug.getError(4930,e)))};return a.addEventListener("load",n),a.addEventListener("error",d),a.src=t,a}function loadVideo(e,o,r){e=base64toArrayBuffer(convertBase64(__adapter_get_resource(e))),r&&r(null,e)}function loadDomAudio(o,r){const e=cc.sys.__audioSupport,t=document.createElement("audio");t.muted=!1;var a=base64ToBlob(__adapter_get_resource(o.split("?")[0]),"audio/mpeg");window.URL?t.src=window.URL.createObjectURL(a):t.src=a;function n(){clearTimeout(d),t.removeEventListener("canplaythrough",l,!1),t.removeEventListener("error",i,!1),e.USE_LOADER_EVENT&&t.removeEventListener(e.USE_LOADER_EVENT,l,!1)}const d=setTimeout(function(){(0===t.readyState?i:l)()},8e3),l=function(){n(),r&&r(null,t)},i=function(){n();var e="load audio failure - "+o;cc.log(e),r&&r(new Error(e))};t.addEventListener("canplaythrough",l,!1),t.addEventListener("error",i,!1),e.USE_LOADER_EVENT&&t.addEventListener(e.USE_LOADER_EVENT,l,!1),t}function loadWebAudio(e,o){var r=cc.sys.__audioSupport.context,t=(r||callback(new Error("Audio Downloader: no web audio context.")),base64toArrayBuffer(__adapter_get_resource(e)));t?r.decodeAudioData(t,function(e){o(null,e)},function(){o("decode error - "+e,null)}):o("request error - "+e,null)}function loadAudio(e,o,r){var t=cc.sys.__audioSupport;if(0===t.format.length)return new Error("Audio Downloader: audio not supported on this browser!");(t.WEB_AUDIO?loadWebAudio:loadDomAudio)(e,r)}function loadFont(e,o,r){const t=e.replace(/[.\/ "'\\]*/g,"");var e=__adapter_get_resource(e);null==e?r():(e=new FontFace(t,"url("+e+")"),document.fonts.add(e),e.load(),e.loaded.then(function(){r(null,t)},function(){cc.warnID(4933,t),r(null,t)}))}function loadBundle(r,e,t){var o=new RegExp("^(?:w+://|.+/).+"),a=cc.path.basename(r),o=(o.test(r)||(r="assets/"+a),e.version||cc.assetManager.downloader.bundleVers[a]);let n=0,d=null,l=null;loadJson(r+`/config.${o?o+".":""}json`,e,function(e,o){e&&(l=e),(d=o)&&(d.base=r+"/"),2===++n&&t&&t(l,d)}),loadScript(r+`/index.${o?o+".":""}js`,e,function(e){e&&(l=e),2===++n&&t&&t(l,d)})}const downloaderList={".png":loadImage,".jpg":loadImage,".bmp":loadImage,".jpeg":loadImage,".gif":loadImage,".ico":loadImage,".tiff":loadImage,".webp":loadImage,".image":loadImage,".mp3":loadAudio,".ogg":loadAudio,".wav":loadAudio,".m4a":loadAudio,".txt":loadText,".xml":loadText,".vsh":loadText,".fsh":loadText,".atlas":loadText,".tmx":loadText,".tsx":loadText,".plist":loadText,".fnt":loadText,".json":loadJson,".ExportJson":loadJson,".mp4":loadVideo,".avi":loadVideo,".mov":loadVideo,".mpg":loadVideo,".mpeg":loadVideo,".rm":loadVideo,".rmvb":loadVideo,".binary":loadArrayBuffer,".bin":loadArrayBuffer,".dbbin":loadArrayBuffer,".skel":loadArrayBuffer,".pvr":loadArrayBuffer,".pkm":loadArrayBuffer,".ttf":loadFont,".font":loadFont,".eot":loadFont,".woff":loadFont,".svg":loadFont,".ttc":loadFont,".js":loadScript,bundle:loadBundle,default:loadText};if(cc.assetManager.downloader.loadScript=loadScript,Object.keys(downloaderList).forEach(e=>{cc.assetManager.downloader.register(e,downloaderList[e])}),cc.VideoPlayer){const setURL=cc.VideoPlayer.Impl.prototype.setURL;cc.VideoPlayer.Impl.prototype.setURL=function(e,o){var r=__adapter_get_resource(e);return r?(r=base64ToBlob(r),r=URL.createObjectURL(r),setURL.call(this,r,o)):setURL.call(this,e,o)}}window.boot&&window.boot()};