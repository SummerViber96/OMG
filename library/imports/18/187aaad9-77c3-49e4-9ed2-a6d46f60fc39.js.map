{"version":3,"sources":["assets\\scripts\\stick.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["\r\n\r\nconst { ccclass, property } = cc._decorator;\r\n\r\n@ccclass\r\nexport default class NewClass extends cc.Component {\r\n    @property(cc.Prefab)\r\n    preCorn: cc.Prefab = null;\r\n    @property(cc.Prefab)\r\n    preTomato: cc.Prefab = null;\r\n    @property(cc.Prefab)\r\n    preCarrot: cc.Prefab = null;\r\n    @property(cc.Node)\r\n    houseCarrrot: cc.Node = null\r\n    @property(cc.Node)\r\n    houseTomato: cc.Node = null;\r\n    @property(cc.Node)\r\n    houseCorn: cc.Node = null;\r\n    @property(cc.AudioClip)\r\n    soundGet: cc.AudioClip = null;\r\n    @property(cc.AudioClip)\r\n    soundHit: cc.AudioClip = null;\r\n    @property(cc.Node)\r\n    hand: cc.Node = null\r\n    @property(cc.Node)\r\n    camera: cc.Node = null\r\n    @property(cc.Node)\r\n    camera2: cc.Node = null\r\n    gamePlay = null\r\n    isDelaySOund = false\r\n    start() {\r\n        this.gamePlay = cc.Canvas.instance.getComponent(\"Game28\");\r\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this.onTouchMove, this);\r\n        this.node.on(cc.Node.EventType.TOUCH_END, this.onTouchEnd, this);\r\n    }\r\n    onTouchMove(event: cc.Event.EventTouch) {\r\n        // console.log(\"move stick\")\r\n        this.hand.active = false\r\n        this.node.getComponent(cc.BoxCollider).enabled = true\r\n        // Lấy vị trí touch\r\n        let touchPos = event.getLocation();\r\n        let pos = cc.v3(0, 0)\r\n        if (this.camera.active == true) {\r\n            pos = this.camera.getComponent(cc.Camera).getScreenToWorldPoint(touchPos)\r\n            touchPos = touchPos.add(cc.v2(this.camera.position.x, this.camera.position.y + 80))\r\n\r\n        }\r\n        else {\r\n            pos = this.camera2.getComponent(cc.Camera).getScreenToWorldPoint(touchPos)\r\n\r\n            touchPos = touchPos.add(cc.v2(this.camera2.position.x, this.camera2.position.y + 80))\r\n\r\n        }\r\n        // Chuyển đổi sang tọa độ của parent\r\n        const localPos = this.node.parent.convertToNodeSpaceAR(pos);\r\n        // Di chuyển stick tới vị trí touch\r\n        this.node.setPosition(localPos);\r\n    }\r\n    onTouchEnd(event) {\r\n        // this.stickNode.active = false\r\n    }\r\n\r\n\r\n    onCollisionEnter(other, self) {\r\n        if (other.node.children[0].name == \"first\") {\r\n            if (other.node.children[1].active) {\r\n                other.node.getComponent(cc.PolygonCollider).enabled = false\r\n                this.cut(other.node)\r\n\r\n            }\r\n\r\n        }\r\n    }\r\n    onCollisionStay(other, self) {\r\n\r\n    }\r\n    cut(node) {\r\n        node.children[0].active = true\r\n\r\n        node.children[1].active = false\r\n        let pos = node.parent.convertToWorldSpaceAR(node.position);\r\n        pos = this.node.parent.convertToNodeSpaceAR(pos);\r\n        switch (this.gamePlay.step) {\r\n            case 1:\r\n                let pop = this.houseCarrrot.getChildByName(\"pop\")\r\n                this.spawItem(this.preCarrot, pop, pos);\r\n                break;\r\n            case 2:\r\n                let pop2 = this.houseTomato.getChildByName(\"pop\")\r\n                this.spawItem(this.preTomato, pop2, pos);\r\n                break;\r\n            case 3:\r\n                let pop3 = this.houseCorn.getChildByName(\"pop\")\r\n                this.spawItem(this.preCorn, pop3, pos);\r\n                break;\r\n\r\n        }\r\n\r\n\r\n\r\n\r\n    }\r\n    isDelaySound2 = false\r\n    spawItem(preItem, pop, pos) {\r\n        let item = cc.instantiate(preItem);\r\n        item.parent = this.node.parent\r\n        item.position = pos\r\n        if (!this.isDelaySOund) {\r\n            this.isDelaySOund = true\r\n            cc.audioEngine.play(this.soundGet, false, 1)\r\n            this.scheduleOnce(() => {\r\n                this.isDelaySOund = false\r\n            }, 0.04)\r\n        }\r\n        let posEnd = pop.parent.convertToWorldSpaceAR(pop.position);\r\n        posEnd = this.node.parent.convertToNodeSpaceAR(posEnd);\r\n        let posMid = cc.v2((pos.x + posEnd.x) / 2, (pos.y + posEnd.y) / 2 + 300)\r\n        cc.tween(item).bezierTo(0.8, cc.v2(pos.x, pos.y), posMid, cc.v2(posEnd.x, posEnd.y + 100)).call(() => {\r\n            item.children[0].active = false\r\n            item.children[1].active = true\r\n            pop.getComponent(\"popFarm\").updateFill()\r\n            if (!this.isDelaySound2) {\r\n                cc.audioEngine.play(this.soundHit, false, 1)\r\n                this.isDelaySound2 = true\r\n                this.scheduleOnce(()=>{\r\n                this.isDelaySound2 = false\r\n\r\n                },0.06)\r\n            }\r\n        }).start()\r\n    }\r\n\r\n\r\n\r\n\r\n\r\n}\r\n"]}